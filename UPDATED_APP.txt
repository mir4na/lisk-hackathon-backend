Prompt

Nama Aplikasi: vessel (dideploy di Lisk Sepolia)

FLOW 1: AUTHENTICATION LOGIN DAN REGISTER

Alur:
REGISTER: register kek biasa akun nama lengkap (sesuai KTP), no. hp, gmail, username, , password, confirmation password -> kirim otp ke gmail, buat verif agar registrasi berhasil. Pengguna perlu mengisi checkbox yang berisi Microcopy (Wajib):
â˜‘ "Saya setuju mendaftar menjadi Anggota Koperasi Jasa VESSEL dan tunduk pada AD/ART yang berlaku."

Pada tahap ini, User baru otomatis memiliki status: Calon Anggota (Pendana).

LOGIN: perlu input email/uname + password. Ketika berhasil login, sistem akan meng issue session berupa JWT Token.

FLOW 2: REQUEST VERIFIKASI SEBAGAI MITRA

Bagi usaha yang ingin menerima pendanaan, bisa upgrade account ke mitra dengan mengisi Form Input:
- Nama Badan Usaha (PT/CV)
- NPWP Badan (15/16 Digit)
- Omzet Tahunan (Dropdown Range)

Upload (PDF/ZIP): NIB, Akta Pendirian, KTP Direktur.

Admin dapat melihat dokumen-dokumen yang diupload usaha-usaha ini (berstatus pending) yang kemudian bisa memverifikasi usaha tersebut dengan mengklik action â€œApprove/Rejectâ€. Jika approve, Update Role User jadi MEMBER_MITRA. Jika Reject, Kirim email notifikasi alasan penolakan.

FLOW 3: SALDO
Sistem menampilkan jumlah saldo user yang sudah dikirimkan untuk funding. Jumlah saldo yang dimiliki suatu user akan diupdate setiap terjadi suatu event yang menambahkan (reibursement) atau mengurangi (funding suatu project) saldo. Saldo yang ditampilkan berupa IDR

FLOW 4: MITRA CREATE INVOICE FUNDING REQUEST 

Alur: Untuk membuat request pendanaan, mitra perlu mengisi beberapa informasi mengenai invoice yang ingin dibiayainya yaitu: 

UI Group 1: Data Pembayar (Buyer)
- Field: Nama Perusahaan Importir.
- Field: Negara Tujuan (Dropdown w/ Flag).
- email utama importir

UI Group 2: Nilai Pengajuan
Field: 
Nominal Invoice
Mata Uang Invoice
Nominal dalam Kurs Konversi Disepakati (IDRX) (ambil dari API Logic BE-4 di bawah)
Tanggal Jatuh Tempo (Tenor), 
Funding Duration (Default 14 Hari)
Field Read-Only: "Estimasi Pencairan Bersih (IDR)"
Set Rasio Tranche (Misal: Prioritas 80%, Katalis 20%).
Set Rate Imbal Hasil (Misal: Prioritas 10%, Katalis 15%).

Microcopy: "Kurs dikunci final untuk melindungi nilai pencairan."

API Logic BE-4 (contoh ketika nominal invoice dalam mata uang USD):
Fetch RealTimeRate (e.g., 1 USD = Rp 15.500).
Tambahkan BufferConfig (e.g., 1.5%).
FixedRate = 15.500 * (1 - 0.015) = 15.267.
Return JSON: {rate: 15267, currency: "IDR"}.

Ket: batas max selama invoice blom terbyarkan

UI: Drag & Drop Zone.
Docs yang diperlukan:
Commercial Invoice
Bill of Lading (BL)
Purchase Order (PO).

Pre-condition Logic (Auto-Check):
1. Saat user input "Nama Importir", Sistem cek Transaction_History.

2. IF Found (Pernah Lunas):  
Otomatis set status: "Repeat Order (Verified by System)". 
Hide pilihan manual.   
Tampilkan Badge: âœ… "Riwayat transaksi terverifikasi."
3. IF Not Found (Data Baru):  
Tampilkan Pertanyaan: "Apakah Anda pernah bertransaksi dengan Importir ini sebelumnya?"   
Opsi A: "Belum Pernah" ->  Show Alert   
Opsi B: "Sudah Pernah" -> Show Form Upload Bukti Lama.

Microcopy Alert:
âš ï¸ "Untuk kemitraan baru, maksimal pembiayaan yang dapat dicairkan adalah 60% dari nilai tagihan."


UI: Halaman Summary.

Checkbox Vital:
â˜‘ "Data yang saya berikan adalah benar dan asli."

Button: "Ajukan Pembiayaan".

FLOW 5: ADMIN REVIEW PERMINTAAN INVOICE FUNDING
Setelah mitra mengajukan funding, funding tersebut perlu disetujui oleh admin terlebih dahulu.

UI: Split Screen (Kiri: Data Input User, Kanan: Preview PDF Dokumen).

Features:
- Zoom/Rotate PDF.
- Button "Valid" / "Revisi" per dokumen.
- Textbox "Catatan Revisi" (Jika ada dokumen salah).

Input Admin:
- Grade suggestion dari BE-ADM-1
- Konfirmasi Grade (A/B/C).

Button valid Effect: Status berubah jadi "Terbitkan ke Marketplace", Smart Contract Minting terpanggil
Logic BE-ADM-1:

- Score_Negara (Tier 1=100, Tier 3=40).
- Score_Histori (Repeat=100, New=50).
- Final_Score = Weighted Average.

- Output: Grade Suggestion (A/B/C).

Alur: apabila status invoice diapprove oleh admin, maka langsung mint invoice. Lalu admin akan mengkonfigurasi dan membut pool funding berdasarkan keterangan request invoice dari eksportir. Setiap invoice yg sudah dimint akan digenerate secara unique untuk diidentifikasi. Informasi yang disimpan dalam blokchain adalah keterangan dari konfigurasi invoice itu sendiri. Lalu setiap invoice yang dibuat akan digenerate payment link


Note: pembayaran dari importir ke eksportir masuknya ke manual case, yang mana tidak dihandle pada aplikasi (asumsikan ketika eksportir membayar ke wallet admin sesuai jumlah yg ditetntukan, maka importir sudah membayar kepada eksportir)

FLOW 6: INVESTOR INGIN MELAKUKAN FUNDING
Investor akan mengunjungi halaman marketplace list, yang mana akan ditampilkan seluruh daftar proyek-proyek yang tersedia.
UI Components:

1. Card Project:
- Judul: "Kopi Arabika Gayo Batch #12"
- Badge Grade: [A / B / C] (Warnanya beda tiap grade)
- Highlight Angka: "Imbal Hasil: 10% - 15% p.a" (Tampilkan range, jangan satu angka, biar user penasaran).
- Tenor: "60 Hari"
- Progress Bar: "Terkumpul 75%"
- Info Buyer: ðŸ‡©ðŸ‡ª Buyer Jerman (Bendera + Negara), pt apa, dll


Logic:
- Bisa sort by: Yield Tertinggi, Tenor Tercepat, Paling Baru.
- Jika Progress == 100%, Card pindah ke tab "Selesai" atau diberi overlay "Fully Funded".

Investor kemudian bisa memasuki salah satu proyek dan melihat detailnya
UI Structure:
1. Header Info: Detail Buyer, Dokumen Legal (Bisa didownload/preview).

2. Tab Selector (Main Feature) dimana investor bisa memilih ingin melakukan tipe funding apa:
- Tab Kiri (Default): [ ðŸ›¡ï¸ Pendanaan Prioritas ]
- Tab Kanan: [ âš¡ Pendanaan Katalis ]

3. Info Box (Berubah sesuai Tab):
- If Prioritas: Tampilkan Wording 
"Dana Anda berada di antrean pertama. Saat Importir membayar, Anda akan menerima pengembalian modal & hasil paling awal. Risikonya lebih rendah karena dilindungi oleh dana Katalis.". Background warna lembut (Biru atau Hijau (Tenang))

- If Katalis: Tampilkan Wording 
"Dana Anda berfungsi sebagai penopang risiko. Anda akan dibayar setelah Pendana Prioritas lunas sepenuhnya. Sebagai ganti risiko ini, Anda mendapatkan imbal hasil lebih tinggi."
Background warna agak mencolok (Oranye atau Ungu (Premium tapi Waspada))


4. Calculator Input:
- Field: "Nominal Pendanaan (Rp)"
- Text: "Estimasi Imbal Hasil (..% p.a)" -> Auto-update sesuai Tab yg dipilih.
- Text: "Estimasi Total Diterima" -> Rumus: Modal + (Modal x Rate x Tenor/360).
UI Action:
Tombol besar di bawah kalkulator: "Danai Sekarang". 

Setelah mengklik tombol â€˜danai sekarangâ€™. User akan memfinalisasi pendanaannya dan melakukan Logic Trigger (Cabang Alur):

Skenario Tab Prioritas Aktif:

1. Muncul Bottom Sheet ringkasan.
2. Checkbox: "Saya menyetujui Syarat & Ketentuan."
3. Input PIN/Biometric.
4. Submit.


Skenario Tab Katalis Aktif:

1. Muncul Full Screen Warning Modal (Warna Merah/Oranye).
2. Wajib Scroll sampai bawah.
3. Wajib Centang 3 Poin:
- [ ] "Saya sadar dana ini menjadi jaminan pertama jika gagal bayar."
- [ ] "Saya siap menanggung risiko kehilangan modal."
- [ ] "Saya paham ini bukan produk bank."
4. Tombol "Lanjut Danai" baru menyala.
5. Input PIN/Biometric.
6. Submit

Logic Backend:

- Setiap proyek punya kuota maksimal per Tranche (Misal Total 100jt: Prioritas 80jt, Katalis 20jt).

- Check 1: Saat user klik "Danai", cek apakah Current_Priority_Fund + Input_User <= Max_Priority_Quota. Begitu juga jika ingin mendanai pada tranche katalis, disesuaikan dengan kuota maksimal katalis saat itu.

- Check 2: Jika melebihi kuota, return error: "Kuota Prioritas sisa Rp 500rb. Mohon kurangi nominal."

- Check 3: Pastikan User ID valid dan Saldo cukup.


Ketika seorang user ingin mendanai, langsung alihkan ke payment gateway midtrans sesuai dengan pilihan metode bayarnya

Tab Pilihan Metode:
Bank
QRIS
Dll.

Target pembayarannya adalah escrow yang akan menahan dananya sementara selama durasi funding terbuka. Ketika pembayaran berhsil, dana akan ditahan hingga kondisi untuk dicairkan ke mitra terpenuhi.

FLOW 7: PENCAIRAN FUNDING KE MITRA

Ketika Project sudah  100% Funded dalam durasi funding yang ditentukan maka

Lakukan Logic:
1. Platform_Fee = Total * 2% (Config).
2. Transfer_Amount = Total - Fee.
3. Panggil API escrow yang akan meneruskan dana ke Rekening Bank Mitra. Namun untuk tahap ini, MVP-nya adalah abstraksi escrow tersebut menjadi suatu dummy handler.
4. Update Status Project: "ACTIVE".

Sistem mengetahui project sudah 100% funded menggunakan event driven trigger, dimana setiap ada penambahan pembiayaan oleh suatu investor, maka sistem otomatis menyimpan jumlah pembiayaan yang telah diraup saat itu. Pada proses penyimpanan itu, bisa dilakukan cek terlebih dahulu apakah project sudah 100% funded atau belum.

FLOW 8: MITRA MEMONITOR FUNDING PROJECTNYA
UI Components:

1. Summary Card:
- "Total Pembiayaan Aktif" (Rp).
- "Sisa Tenor Rata-rata" (Hari).

2. Timeline Tracker (Visual Step):
- [âœ…] Penggalangan Dana
- [âœ…] Dana Cair
- [â³] Disbursement ke funder

3. Action Button: "Unduh Surat NOA" (PDF) untuk dikirim ke Buyer.

4. Table: List Invoice Aktif (Kolom: Buyer, Jatuh Tempo, Nominal, Status).

Microcopy (Status):
- "Aktif": Belum jatuh tempo.
- "Dalam Pengawasan": Lewat jatuh tempo < 30 hari.
API Logic: GET /mitra/dashboard


1. Query semua project dengan mitra_id = user_id.

2. Filter status ACTIVE atau OVERDUE.

3. Hitung days_remaining = due_date - current_date.

4. Jika days_remaining < 0, flag status jadi "OVERDUE" (Kuning).

Pada tahap ini, Mitra bisa memilih untuk melakukan disbursement terhadap dana yang diterima sebelumnya untuk kembali ke pembiaya, flow ini akan dibahas pada FLOW 11, yang membahas disbursement eksportir/mitra ke investor.

FLOW 9: RINGKASAN FUNDING INVESTOR
Investor dapat melihat ringkasan funding yang telah dilakukannya
UI Components:

1. Card "Total Pembiayaan": (Saldo Dana yang Sedang Disalurkan).
2. Card "Total Imbal Hasil Diterima": Akumulasi profit yang sudah terealisasi (Realized Gain).
3. Chart: Donut Chart "Sebaran Dana"

- Biru: Prioritas (Senior)
- Oranye: Katalis (Junior)

Wording Aman: Gunakan "Nilai Pembiayaan Berjalan" (bukan 'Investasi').

Peran backend adalah untuk mengambil informasi berupa data-data pembiayaan yang telah dilakukan dan yang sedang aktif agar bisa disajikan dalam UI tersebut. 

FLOW 10: LIST PEMBIAYAAN AKTIF INVESTOR
UI Columns:

1. Nama Proyek (e.g. Kopi Gayo #12)
2. Tipe (Prioritas / Katalis)
3. Modal Disalurkan (Rp)
4. Estimasi Hasil (Rp)
5. Status (Label Berwarna)
Logic Status Color:
- ðŸŸ¢ Lancar (On-Track)
- ðŸŸ¡ Perhatian (H+1 s/d H+30 Jatuh Tempo)
- ðŸ”´ Gagal Bayar (>H+30, masuk klaim asuransi)
API Logic: GET /investor/portfolio
Disini backend hanya perlu untuk listing setiap pembiayaan suatu project yang sedang aktif, beserta informasi yang ditampilkan pada UI-nya. Estimasi hasil dihitung dengan jumlah kontribusi funding dikalikan dengan bunga yang didapat. Untuk perhitungan status, sesuaikan dengan logika uinya.

FLOW 11: EKSPORTIR DISBURSEMENT KE INVESTOR
Pada tahap ini, eksportir sudah menerima dana dari importir (dilakukan di luar aplikasi), dan sekarang eksportir ingin disbursement ke investornya minimal sebanyak total funding yang didapat sebelumnya + persentase bunga yang ditentukan sebelumnya. Di sini, eksportir akan membayar ke rekening suatu escrow, dan sistem akan memberikan instruksi ke API yang disediakan escrow berupa target-target rekening transfer investornya, dan masing-masing yang didapatnya, berdasarkan kalkulasi pembagian hasilnya (persentase imbal hasil prioritas atau katalis). Pada tahap ini, MVP berupa abstraksi escrow terlebih dahulu, jadi buatkan dummy handler untuk peran escrow tersebut. Hasilnya adalah hasil disbursement + imbal hasil masuk langsung ke rekening setiap investor. 

Pada kasus dimana eksportir hanya membayar sebagian, pastikan mengikuti logic dimana prioritas dibayar terlebih dahulu, dan katalis dibayar sisanya (jika ada).



â€”---------------------------------------------------------------------------------------------------------------------------------

Untuk mencari request pendaan yang sedang terbuka, investor mengunjungi halaman â€œmarketplaceâ€ dan bisa filter funding berdasarkan gradenya (A/B/C) dan flag â€œInsuredâ€. Grade berdasarkan matrix risiko:
Negara buyer (Jerman=low risk, Nigeria=high risk)
History exportir (Sering=A, Pertama kali=C)
Kelengkapan dokumen (Ada=A, tidak=C)

Pada setiap funding project, ditampilkan juga bar progress pendanaan, sisa durasi waktu, dan juga rasio junior dan senior. Setiap investor akan diperlukan untuk mengisi 

Pertanyaan 1: "Apa tujuan investasi Anda?"
A. Dana darurat (Aman)
B. Tabungan jangka panjang
C. Mencari keuntungan agresif (Spekulasi) -> Poin plus untuk Junior Tranche

Pertanyaan 2: "Jika Invoice macet dan asuransi ditolak, apakah Anda siap kehilangan 100% modal Anda?"
A. Tidak, saya akan menuntut platform.
B. Ya, saya sadar ini risiko modal ventura. -> Wajib pilih B untuk jadi Junior

Pertanyaan 3: "Apakah Anda mengerti bahwa dana di Junior Tranche baru dibayar setelah Senior Tranche lunas sepenuhnya?"
A. Tidak mengerti.
B. Mengerti.

(liat cheatsheet)
Logic: Jika user jawab "Spekulasi" & "Siap Rugi" -> Unlock fitur Junior Tranche. Jika tidak -> Hide/Lock fitur tersebut.

Note: Importir bakal bayar ke eksportir di luar aplikasi. Jadinya, eksportirlah yang berkewajiban untuk membayar ke wallet address aplikasi yang akan disalurkan secara otomatis ke investor.

Alur: saat investor ingin invest ke pool funding yang sudah dikonfigurasi, maka investor harus invest melalui idrx dari wallet addressnya.



Filter: Grade (A/B/C), Tenor (1-3 Bulan), Yield Tertinggi.

Card Info: Nama Project (e.g., "Kopi Gayo Batch #9"), Grade, Bunga (APY), Tenor, Progress Bar (Dana Terkumpul).

Badges: "Insured 80%", "Repeat Borrower"
Chart: Pie Chart "Struktur Pendanaan" (Senior vs Junior vs Buffer).


Simulator: Input "Rp 10.000.000" -> Output "Estimasi Return: Rp 250.000".


Tabs: "Pilih Senior (Aman)" vs "Pilih Junior (Cuan)".
If Senior: Input Nominal -> Button "Invest Sekarang".


If Junior: Input Nominal -> Pop-up Warning Merah: "Dana Junior adalah first-loss capital. Anda bisa rugi 100%. Saya mengerti." -> Checkbox -> Button "Lanjut".



Note: dana di funding pool bakal otomatis di tf ke eksportir melalui wallet address setelah deadline pool funding selesai.



Bunga Harian (Simple Interest)
(Pokok Pinjaman * Bunga Tahunan * Jumlah Hari) / 360


Contoh: Pinjam 100jt, Bunga 12% p.a, 60 hari.

Bunga = (100jt * 0.12 * 60) / 360 = Rp 2.000.000
Total Pengembalian (Repayment)
Pokok Pinjaman + Bunga Harian
Scoring Bobot (Admin)
Dokumen (55%): Lengkap=100, Kurang=0.
History (45%): Repeat=100, New=50.

Final Score:
Grade Determination
Score > 85: Grade A (Rate 12%, Tranche 90:10)
Score 70-84: Grade B (Rate 15%, Tranche 80:20)
Score < 70: Grade C (Rate 18%, Tranche 60:40)

